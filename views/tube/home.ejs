<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>わかめtube</title>
    <link rel="stylesheet" href="/css/page.css">
    <script src="/js/tailwindcss.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="/js/tube.js"></script>
    <style>
        .hero-section {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50vh;
            background-color: #2d3748;
        }
        .searchbox {
            position: absolute;
            transform: translate(-50%, 0%);
            width: 80%;
            max-width: 700px;
            padding: 0.75rem;
            font-size: 1.2rem;
            border-radius: 25px;
            border: none;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            outline: none;
            transition: all 0.3s ease;
        }
        .searchbox:focus {
            background-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }
        .app-card-container {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        .app-card {
            background-color: #1a202c;
            border-radius: 25px;
            padding: 15px;
            width: 180px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 2px solid #4a5568;
        }
        .app-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 4px 10px rgba(255, 255, 255, 0.1);
        }
        .app-card img {
            width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .app-card h3 {
            color: white;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        .app-card p {
            color: #cbd5e0;
            font-size: 0.875rem;
        }
        footer {
            background-color: #2d3748;
            color: #cbd5e0;
            padding: 1rem;
            text-align: center;
            margin-top: 50px;
        }
        .logo img {
            height: 30px;
            width: auto;
        }
    </style>
</head>
<body class="bg-gray-900 font-sans">

    <header class="bg-gray-800 text-white p-4">
        <nav class="flex justify-between items-center">
            <a href="/?r=y" class="logo">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2121.jpeg">
            </a>
            <div class="space-x-6">
                <button id="openSettings" class="hover:text-gray-300">⚙️設定</button>
                <a href="/wkt/trend" class="hover:text-gray-300">🎩トレンド</a>
                <a href="/wkt/cl/history" class="hover:text-gray-300">履歴</a>
                <a href="/wkt/cl/fav" class="hover:text-gray-300">お気に入り</a>
            </div>
        </nav>
    </header>
  
    <section class="hero-section">
        <div class="text-center">
            <a href="/blog/b/wkthelp"><h1 class="text-4xl font-bold text-white mb-4">わかめtube</h1></a>
            <p class="text-lg text-gray-400 mb-6">好きな動画を検索してみましょう！</p>
            <form action="/wkt/s" method="get" id="searchForm">
              <input type="text" name="q" id="searchbox" placeholder="キーワード、もしくはYouTubeのURLを入力..." class="searchbox">
            </form>
        </div>
    </section>

    <section class="py-10 px-4 bg-gray-800">

        <div class="app-card-container">
            <div class="app-card">
                <a href="/pp">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2940.jpeg">
                </a>
                <h3>WAO!</h3>
                <p>Proxyを見つけて、使う。</p>
            </div>
            <div class="app-card">
                <a href="/game">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2941.png">
                </a>
                <h3>APP</h3>
                <p>Webゲームをプレイ。</p>
            </div>
            <div class="app-card">
                <a href="/wakams">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2942.jpeg">
                </a>
                <h3>Music</h3>
                <p>音楽を聴くためのアプリ</p>
            </div>
            <div class="app-card">
                <a href="/tools">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2945.jpeg">
                </a>
                <h3>ツール</h3>
                <p>あなたを助けるかもしれない</p>
            </div>
            <div class="app-card">
                <a href="https://docs.google.com/forms/d/e/1FAIpQLScVhfR8U8-6t7oWVZuQGBmHTeqsYwGppvqNOtizcGHVmgjGzA/viewform">
                <img src="https://cdn.glitch.global/21c63086-ffc1-4d28-8e9a-e2c12f51b431/IMG_2944.png">
                </a>
               
            </div>
        </div>
    </section>

<div id="settingsPanel" class="fixed top-0 left-0 w-full bg-white dark:bg-gray-900 shadow-lg p-6 -translate-y-full duration-300">
    <div class="bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white max-w-2xl mx-auto bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md">
      <h1 class="text-2xl font-bold mb-4">再生方法の設定</h1>
      <p class="mb-4 text-gray-700 dark:text-gray-300">再生方法を選択してください。詳しくは<a href="/blog/b/wkthelp" style="color: #60a5fa; text-decoration: underline; transition: color 0.3s ease;">ヘルプ</a>をみてね</p>
      
      <form id="settingsForm" class="space-y-4">
        <label class="block p-4 border rounded-lg cursor-pointer dark:border-gray-700">
          <input type="radio" name="playbackMode" value="normal" class="mr-2"> 
          <span class="font-semibold">通常</span>
          <p class="text-sm text-gray-600 dark:text-gray-400">通常の再生方法で、ストリームを取得して再生を行います。</p>
        </label>
        
        <label class="block p-4 border rounded-lg cursor-pointer dark:border-gray-700">
          <input type="radio" name="playbackMode" value="edu" class="mr-2"> 
          <span class="font-semibold">Edu</span>
          <p class="text-sm text-gray-600 dark:text-gray-400">youtubeeducationを埋め込んで再生を行います。</p>
        </label>
        
        <label class="block p-4 border rounded-lg cursor-pointer dark:border-gray-700">
          <input type="radio" name="playbackMode" value="nocookie" class="mr-2"> 
          <span class="font-semibold">NoCookie</span>
          <p class="text-sm text-gray-600 dark:text-gray-400">youtubenocookieを埋め込んで再生を行います。</p>
        </label>
        
        <label class="block p-4 border rounded-lg cursor-pointer dark:border-gray-700">
          <input type="radio" name="playbackMode" value="direct" class="mr-2"> 
          <span class="font-semibold">デフォルトでDirectサーバーを利用する</span>
          <p class="text-sm text-gray-600 dark:text-gray-400">再生方法としては「通常」に分類されます。動画取得サーバーを経由せず、このサイトから直接リクエストを送ってストリームを取得します。これをデフォルトで行います。</p>
        </label>
        
        <button type="button" id="saveButton" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors">保存</button>
      </form>

      <button id="closeSettings" class="absolute top-4 right-4 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-4xl font-bold w-12 h-12 flex items-center justify-center rounded-full hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
        ×
      </button>
    </div>
</div>

    <footer>
        <p>♪( ´▽｀)</p>
    </footer>

<script>
document.getElementById("searchForm").addEventListener("submit", function(event) {
    event.preventDefault();
    const query = document.getElementById("searchbox").value.trim();
    const ytRegex = /(?:https?:\/\/)?(?:www\.)?youtu(?:\.be\/|be\.com\/(?:watch\?v=|embed\/|v\/|shorts\/))([\w\-]+)/;
    const match = query.match(ytRegex);
    if (match) {
        const videoId = match[1];
        showMessage(`YouTubeのURLとして処理されました☑️`);
        window.location.href = `/wkt/w/${videoId}`;
    } else {
        this.submit();
    }
});

window.addEventListener("load", function() {
    const hometut = localStorage.getItem('homec');
    if (!hometut) {
      showMessage("ようこそ！もし何か知りたい場合<a href='/blog/b/wkthelp' style='color: #60a5fa;'>ヘルプページ</a>を見てみて下さい。");
      localStorage.setItem('homec', 'true');
    } else if(hometut === "true"){
      showMessage("このサイトは誰でも作ることができます！詳しくは<a href='/blog/b/wkthelp' style='color: #60a5fa;'>わかめtubeを作ってみる</a>を見てみて下さい！");
      localStorage.setItem('homec', 'ok');
    }
});

function showMessage(text) {
    const alertMessage = document.createElement('div');
    alertMessage.classList.add(
        'fixed', 'top-4', 'right-4', 'bg-gradient-to-r',
        'from-gray-800', 'to-gray-600', 'text-white',
        'p-5', 'rounded-lg', 'shadow-xl', 'opacity-90',
        'z-50', 'transform', 'scale-100', 'transition-all',
        'border-2', 'border-indigo-500', 'cursor-pointer'
    );
    alertMessage.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
    alertMessage.innerHTML = `
        <div class="flex items-center justify-between space-x-4">
            <span class="font-semibold">ℹ︎ ${text}</span>
            <button class="text-white hover:text-gray-300 focus:outline-none text-xl font-bold" aria-label="閉じる">&times;</button>
        </div>
    `;
    document.body.appendChild(alertMessage);
    const closeButton = alertMessage.querySelector('button');
    const autoRemoveTimer = setTimeout(() => {
        hideMessage(alertMessage);
    }, 3500);
    closeButton.addEventListener('click', () => {
        clearTimeout(autoRemoveTimer);
        hideMessage(alertMessage);
    });
    let startX = null;
    let currentX = 0;
    let moved = false;
    alertMessage.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        moved = false;
        alertMessage.style.transition = 'none';
    });
    alertMessage.addEventListener('touchmove', (e) => {
        if (startX === null) return;
        const touch = e.touches[0];
        const deltaX = touch.clientX - startX;
        if (Math.abs(deltaX) > 5) moved = true;
        currentX = deltaX;
        alertMessage.style.transform = `translateX(${deltaX}px) scale(1)`;
    });
    alertMessage.addEventListener('touchend', () => {
        alertMessage.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
        if (moved && Math.abs(currentX) > 100) {
            alertMessage.style.opacity = '0';
            alertMessage.style.transform = `translateX(${currentX > 0 ? 500 : -500}px) scale(0.95)`;
            setTimeout(() => alertMessage.remove(), 300);
        } else {
            alertMessage.style.transform = 'translateX(0) scale(1)';
        }
        startX = null;
        currentX = 0;
        moved = false;
    });
}
function hideMessage(elem) {
    elem.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
    elem.style.opacity = '0';
    elem.style.transform = 'translateX(100%) scale(1.1)';
    setTimeout(() => elem.remove(), 300);
}
  
document.getElementById('openSettings').addEventListener('click', () => {
      document.getElementById('settingsPanel').classList.remove('-translate-y-full');
    });
    
    document.getElementById('closeSettings').addEventListener('click', () => {
      document.getElementById('settingsPanel').classList.add('-translate-y-full');
    });
    
    document.getElementById('saveButton').addEventListener('click', () => {
      const mode = document.querySelector('input[name=playbackMode]:checked').value;
      document.cookie = `playbackMode=${mode}; path=/; max-age=31536000`;
      document.getElementById('settingsPanel').classList.add('-translate-y-full');
      showMessage(`再生方法を${mode}に変更しました☑️`);
    });
    
    window.addEventListener('DOMContentLoaded', () => {
      const cookies = document.cookie.split('; ').reduce((acc, cookie) => {
        const [key, value] = cookie.split('=');
        acc[key] = value;
        return acc;
      }, {});
      const playbackMode = cookies.playbackMode || 'normal';
      document.querySelector(`input[value="${playbackMode}"]`).checked = true;
    });
</script>
</body>
</html>
